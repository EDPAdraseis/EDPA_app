import React,{useState,useEffect,useRef}from'react';import{TreePine,Calendar,Info,Mail,Bell,MapPin,Users,ChevronRight,Menu,X,Phone,Heart,Map as MapIcon,Navigation,LocateFixed}from'lucide-react';const App=()=>{const[activeTab,setActiveTab]=useState('home');const[isMenuOpen,setIsMenuOpen]=useState(false);const[notifications,setNotifications]=notifications === undefined ? useState(2) : [notifications, setNotifications];const[selectedLocation,setSelectedLocation]=useState(null);const mapRef=useRef(null);const leafletMap=useRef(null);const userMarkerRef=useRef(null);const[leafletLoaded,setLeafletLoaded]=useState(false);const locations=[{id:1,name:"Θρακομακεδόνες (Βάση)",lat:38.1415,lng:23.7645,desc:"Σημείο συνάντησης στην κεντρική πλατεία για καθαρισμούς μονοπατιών."},{id:2,name:"Καταφύγιο Μπάφι",lat:38.1677,lng:23.7258,desc:"Κεντρικό ορειβατικό καταφύγιο. Σημείο συγκέντρωσης για αναδασώσεις."},{id:3,name:"Καταφύγιο Φλαμπούρι",lat:38.1722,lng:23.7431,desc:"Δευτερεύον σημείο συνάντησης και παρατήρησης."},{id:4,name:"Θέση Μόλα",lat:38.1845,lng:23.7165,desc:"Περιοχή υψηλής προστασίας. Χώρος δράσεων αναδάσωσης."},{id:5,name:"Τελεφερίκ / Καζίνο",lat:38.1511,lng:23.7250,desc:"Σημείο εκκίνησης περιπολιών πυρασφάλειας στη νότια πλευρά."}];const actions=[{id:1,title:"Αναδάσωση στην περιοχή Μόλα",date:"Κυριακή 15 Φεβρουαρίου",time:"09:00",type:"Αναδάσωση",location:"Πάρνηθα - Θέση Μόλα"},{id:2,title:"Προληπτική Περιπολία",date:"Σάββατο 21 Φεβρουαρίου",time:"18:00",type:"Πυρασφάλεια",location:"Περιοχή Καζίνου"}];const news=[{id:1,title:"Νέος εξοπλισμός πυρασφάλειας",summary:"Παραλαβή νέων ασυρμάτων για τις περιπολίες.",date:"2 ημέρες πριν"},{id:2,title:"Επιτυχής δενδροφύτευση",summary:"Φυτεύτηκαν 500 έλατα στην περιοχή Μόλα.",date:"1 εβδομάδα πριν"}];useEffect(()=>{if(activeTab==='map'&&!leafletLoaded){const link=document.createElement('link');link.rel='stylesheet';link.href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';document.head.appendChild(link);const script=document.createElement('script');script.src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';script.async=true;script.onload=()=>setLeafletLoaded(true);document.body.appendChild(script)}},[activeTab,leafletLoaded]);useEffect(()=>{if(activeTab==='map'&&leafletLoaded&&mapRef.current&&typeof L!=='undefined'){if(leafletMap.current){leafletMap.current.remove()}const map=L.map('map-container',{zoomControl:false,fadeAnimation:true}).setView([38.16,23.74],12);leafletMap.current=map;L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; OSM',maxZoom:19}).addTo(map);locations.forEach(loc=>{const marker=L.marker([loc.lat,loc.lng]).addTo(map);marker.on('click',()=>{setSelectedLocation(loc)})});const fixMap=()=>{map.invalidateSize();window.dispatchEvent(new Event('resize'))};const ro=new ResizeObserver(fixMap);ro.observe(mapRef.current);[100,300,600,1000].forEach(d=>setTimeout(fixMap,d));return()=>{ro.disconnect();map.remove();leafletMap.current=null}}},[activeTab,leafletLoaded]);useEffect(()=>{if(leafletMap.current){const upd=()=>{if(leafletMap.current)leafletMap.current.invalidateSize({animate:true})};[50,200,400,700].forEach(d=>setTimeout(upd,d))}if(!selectedLocation&&leafletMap.current){leafletMap.current.closePopup()}},[selectedLocation]);const handleLocateMe=()=>{if(!leafletMap.current)return;leafletMap.current.locate({setView:true,maxZoom:15});leafletMap.current.once('locationfound',(e)=>{if(userMarkerRef.current){leafletMap.current.removeLayer(userMarkerRef.current)}userMarkerRef.current=L.circleMarker(e.latlng,{radius:8,fillColor:"#3b82f6",color:"#fff",weight:2,opacity:1,fillOpacity:0.8}).addTo(leafletMap.current)})};const Navbar=()=>(<nav className="bg-emerald-800 text-white p-4 sticky top-0 z-50 shadow-md"><div className="flex justify-between items-center max-w-lg mx-auto"><div className="flex items-center gap-2"><TreePine className="w-8 h-8 text-emerald-300"/><h1 className="font-bold text-lg leading-tight">Εθελοντική Δράση<br/><span className="text-sm font-normal">Πάρνηθας</span></h1></div><div className="flex items-center gap-4"><div className="relative"><Bell className="w-6 h-6"/>{notifications > 0 && <span className="absolute -top-1 -right-1 bg-red-500 text-[10px] rounded-full w-4 h-4 flex items-center justify-center">{notifications}</span>}</div><button onClick={()=>setIsMenuOpen(true)}><Menu className="w-7 h-7"/></button></div></div></nav>);const HomeScreen=()=>(<div className="space-y-6 animate-in fade-in duration-500"><div className="bg-emerald-900 text-white rounded-2xl p-6 relative overflow-hidden shadow-lg"><div className="relative z-10"><h2 className="text-2xl font-bold mb-2">Γίνε Εθελοντής!</h2><p className="text-emerald-100 mb-4 text-sm">Προστάτεψε τον πνεύμονα της Αθήνας.</p><button className="bg-white text-emerald-900 px-4 py-2 rounded-lg font-bold text-sm shadow-sm active:scale-95 transition-transform">Συμμετοχή</button></div><Heart className="absolute -bottom-4 -right-4 w-32 h-32 text-emerald-800 opacity-50"/></div><section><h3 className="font-bold text-lg text-slate-800 mb-4 px-1">Νέα του Συλλόγου</h3><div className="space-y-3">{news.map(item=>(<div key={item.id} className="bg-white p-4 rounded-xl border border-slate-100 shadow-sm"><span className="text-[10px] text-slate-400 font-medium uppercase">{item.date}</span><h4 className="font-bold text-slate-800 leading-tight">{item.title}</h4><p className="text-slate-600 text-sm line-clamp-2 mt-1">{item.summary}</p></div>))}</div></section></div>);const MapView=()=>(<div className="h-full flex flex-col animate-in zoom-in duration-300 overflow-hidden"><h2 className="text-2xl font-bold text-slate-800 mb-2 px-1 text-center sm:text-left">Πραγματικός Χάρτης</h2><p className="text-slate-500 text-xs mb-4 px-1 text-center sm:text-left">Επιλέξτε ένα σημείο συνάντησης.</p><div className="relative flex-1 bg-slate-200 rounded-[2.5rem] overflow-hidden border-2 border-emerald-100 shadow-inner" style={{minHeight:'400px'}}>{!leafletLoaded&&(<div className="absolute inset-0 flex flex-col items-center justify-center bg-emerald-50 text-emerald-800 z-30"><div className="animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-800 mb-2"></div><p className="text-xs font-bold uppercase tracking-widest">Φόρτωση...</p></div>)}<div id="map-container" ref={mapRef} className="absolute inset-0 z-0 h-full w-full" style={{background:'#e5e7eb'}}></div><button onClick={handleLocateMe} className="absolute top-4 right-4 z-20 bg-white p-3 rounded-full shadow-2xl text-emerald-700 active:scale-90 transition-transform border border-emerald-50"><LocateFixed className="w-6 h-6"/></button>{selectedLocation&&(<div className="absolute bottom-6 left-4 right-4 bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl p-5 z-20 border border-emerald-100 animate-in slide-in-from-bottom duration-300"><div className="flex justify-between items-start mb-2"><h3 className="font-bold text-emerald-900 text-lg leading-tight">{selectedLocation.name}</h3><button onClick={()=>setSelectedLocation(null)} className="text-slate-400 p-1.5 hover:bg-slate-100 rounded-full transition-colors"><X className="w-6 h-6"/></button></div><p className="text-xs text-slate-600 mb-5 leading-relaxed">{selectedLocation.desc}</p><button className="flex items-center justify-center gap-2 w-full bg-emerald-700 text-white py-3.5 rounded-xl text-sm font-bold shadow-lg active:bg-emerald-800 active:scale-[0.98] transition-all"><Navigation className="w-4 h-4"/> Πλοήγηση Σημείου</button></div>)}</div></div>);return(<div className="flex flex-col h-screen bg-slate-50 font-sans text-slate-900 max-w-lg mx-auto shadow-2xl overflow-hidden"><Navbar/><main className="flex-1 p-5 overflow-y-auto pb-24">{activeTab==='home'&&<HomeScreen/>}{activeTab==='map'&&<MapView/>}{activeTab==='actions'&&( <div className="space-y-4"> <h2 className="text-2xl font-bold text-slate-800">Πρόγραμμα Δράσεων</h2> {actions.map(action=>( <div key={action.id} className="bg-white rounded-xl border border-slate-100 shadow-sm p-4"> <span className="text-[10px] font-bold text-emerald-700 bg-emerald-50 px-2 py-1 rounded-full uppercase mb-2 inline-block">{action.type}</span> <h3 className="font-bold text-slate-800 mb-2">{action.title}</h3> <div className="flex items-center gap-4 text-xs text-slate-500"> <div className="flex items-center gap-1"><Calendar className="w-3 h-3"/> {action.date}</div> <div className="flex items-center gap-1"><MapPin className="w-3 h-3"/> {action.location}</div> </div> </div> ))} </div> )}{activeTab==='contact'&&( <div className="space-y-4"> <h2 className="text-2xl font-bold text-slate-800">Επικοινωνία</h2> <div className="bg-white p-6 rounded-xl shadow-sm space-y-4"> <div className="flex items-center gap-3 text-emerald-800 font-semibold"><Phone className="w-5 h-5"/> 210 24XXXXX</div> <div className="flex items-center gap-3 text-emerald-800 font-semibold"><Mail className="w-5 h-5"/> info@parnitha.gr</div> <hr className="border-slate-50"/> <button className="w-full bg-emerald-800 text-white py-3.5 rounded-xl font-bold shadow-lg active:scale-95 transition-transform">Γίνε Μέλος Τώρα</button> </div> </div> )}</main><div className="fixed bottom-0 left-0 right-0 z-50 max-w-lg mx-auto bg-white/95 backdrop-blur-md border-t border-slate-100 px-2 py-3 shadow-[0_-10px_15px_-3px_rgba(0,0,0,0.05)]"><div className="flex justify-around items-end"><button onClick={()=>setActiveTab('home')} className={`flex flex-col items-center gap-1 w-14 ${activeTab==='home'?'text-emerald-700 scale-105 font-bold':'text-slate-400'}`}><TreePine className="w-6 h-6"/><span className="text-[9px]">Αρχική</span></button><button onClick={()=>setActiveTab('actions')} className={`flex flex-col items-center gap-1 w-14 ${activeTab==='actions'?'text-emerald-700 scale-105 font-bold':'text-slate-400'}`}><Calendar className="w-6 h-6"/><span className="text-[9px]">Δράσεις</span></button><button onClick={()=>setActiveTab('map')} className="relative -top-6 group"><div className={`p-4 rounded-full shadow-xl transition-all ${activeTab==='map'?'bg-emerald-700 text-white ring-8 ring-emerald-50':'bg-emerald-600 text-white shadow-emerald-200'}`}><MapIcon className="w-7 h-7"/></div><span className="text-[9px] font-bold text-emerald-800 block text-center mt-1">Χάρτης</span></button><button onClick={()=>setActiveTab('contact')} className={`flex flex-col items-center gap-1 w-14 ${activeTab==='contact'?'text-emerald-700 scale-105 font-bold':'text-slate-400'}`}><Mail className="w-6 h-6"/><span className="text-[9px]">Επαφή</span></button></div><div className="h-4"></div></div>{isMenuOpen&&(<div className="fixed inset-0 bg-black/60 z-[70] animate-in fade-in" onClick={()=>setIsMenuOpen(false)}><div className="absolute right-0 top-0 h-full w-72 bg-white p-8 shadow-2xl animate-in slide-in-from-right" onClick={e=>e.stopPropagation()}><div className="flex justify-between items-center mb-10"><h3 className="text-xl font-bold">Πλοήγηση</h3><button onClick={()=>setIsMenuOpen(false)}><X className="w-7 h-7 text-slate-400"/></button></div><ul className="space-y-8 text-lg font-medium text-slate-700"><li className="flex items-center gap-4"><TreePine className="text-emerald-600"/> Σχετικά με εμάς</li><li className="flex items-center gap-4"><Users className="text-emerald-600"/> Μέλη & Εθελοντές</li><li className="flex items-center gap-4 text-red-600 font-bold"><Phone/> Έκτακτη Ανάγκη</li></ul></div></div>)}</div>)};export default App;